<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>UrbanWear | Cart</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 sticky-top">
  <a class="navbar-brand fw-bold" href="index.html">UrbanWear</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="nav">
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="products.html">Products</a></li>
      <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
      <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
      <li class="nav-item"><a class="btn btn-outline-light ms-2" href="cart.html">ðŸ›’ Cart</a></li>
    </ul>
  </div>
</nav>

<div class="container mt-5">
  <h2 class="mb-4">Your Shopping Cart</h2>
  <div class="table-responsive">
    <table class="table table-bordered align-middle text-center">
      <thead class="table-dark">
        <tr>
          <th>Product</th>
          <th>Name</th>
          <th>Price (PKR)</th>
          <th>Quantity</th>
          <th>Subtotal</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="cartTable">
      </tbody>
    </table>
  </div>
  <div class="d-flex justify-content-between align-items-center mt-4">
    <h4>Total: PKR <span id="cartTotal">0</span></h4>
    <a href="checkout.html" class="btn btn-success btn-lg">Proceed to Checkout</a>
  </div>
</div>

<script>
let cart = JSON.parse(localStorage.getItem("cart"))||[];

function renderCart(){
  const table = document.getElementById("cartTable");
  table.innerHTML = "";
  let total = 0;
  cart.forEach((item,index)=>{
    const subtotal = item.price * (item.qty || 1);
    total += subtotal;
    table.innerHTML += `
      <tr>
        <td><img src="${item.image}" style="height:60px; object-fit:cover;"></td>
        <td>${item.name}</td>
        <td>${item.price}</td>
        <td>
          <button class="btn btn-sm btn-outline-secondary" onclick="updateQty(${index},-1)">-</button>
          <span class="mx-2">${item.qty || 1}</span>
          <button class="btn btn-sm btn-outline-secondary" onclick="updateQty(${index},1)">+</button>
        </td>
        <td>${subtotal}</td>
        <td><button class="btn btn-sm btn-danger" onclick="removeItem(${index})">Remove</button></td>
      </tr>
    `;
  });
  document.getElementById("cartTotal").innerText = total;
  localStorage.setItem("cart",JSON.stringify(cart));
}

function updateQty(index,change){
  if(!cart[index].qty) cart[index].qty=1;
  cart[index].qty += change;
  if(cart[index].qty<1) cart[index].qty=1;
  renderCart();
}

function removeItem(index){
  cart.splice(index,1);
  renderCart();
}

// Add image property if missing
cart = cart.map(item=>{
  if(!item.image){
    const p = products.find(x=>x.name==item.name);
    if(p) item.image=p.image;
  }
  return item;
});

renderCart();
</script>

</body>
</html>
